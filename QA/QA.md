##### 1. goroutine 的调度

M-P-G

M: OS 线程, 称之为 Machine, 是实际的执行体, 不保持状态

G: goroutine, 仅仅保存任务状态, 包括栈, 指令指针, 以及其他信息, 比如阻塞它的 channel

P: processor



P 有一个 runqueue, 用于存放准备好被调度的 G, 全局还有一个 runqueue

P 不断循环取出 runqueue 中的 G, 交给 M 执行.

M  拿到 G 之后, 取出 G 中保存的状态, 继续执行. 如果需要中途切换, 则将相关寄存器值保存回 G. 任何 M 都可以恢复执行这个 G.



P 可以重新绑定 M



##### 2. 抢占式调度

协作式多任务处理: 下一个进程被调度的前提是当前进程主动放弃

抢占式多任务处理: 操作系统可以剥夺耗时长的时间片, 提供给其他进程.



##### 3. 堆和栈

栈是随函数调用时分配的内存, 是临时的, 函数执行结束即释放

堆是在整个进程未分配空间中的内存